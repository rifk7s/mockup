<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - JobFinder</title>
    
    <!-- Google Fonts - Rubik -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="../src/output.css">
</head>
<body class="rubik-regular bg-gray-50 text-gray-900">
    <!-- Navigation Header -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="../index.html" class="rubik-bold text-2xl text-blue-600">JobFinder</a>
                </div>
                
                <!-- Navigation Links -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="../index.html" class="text-gray-600 hover:text-blue-600 transition-colors">Home</a>
                    <a href="jobs.html" class="text-gray-600 hover:text-blue-600 transition-colors">Jobs</a>
                    <a href="companies.html" class="text-gray-600 hover:text-blue-600 transition-colors">Companies</a>
                    <a href="profile.html" class="text-blue-600 rubik-medium">Profile</a>
                </div>
                  <!-- User Menu -->
                <div class="flex items-center space-x-4" id="user-menu">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </nav>

    <!-- Profile Content -->
    <section class="py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col lg:flex-row gap-8">
                <!-- Profile Sidebar -->
                <div class="lg:w-1/3">                    <!-- Profile Card -->
                    <div class="bg-white rounded-lg shadow-sm p-6 mb-6" id="profile-card">
                        <!-- Loading state -->
                        <div id="profile-loading" class="text-center">
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div>
                            <p class="text-gray-500 mt-2">Loading profile...</p>
                        </div>
                        
                        <!-- Profile content -->
                        <div id="profile-content" class="hidden">
                            <div class="text-center">
                                <div id="profile-avatar" class="w-24 h-24 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 text-white text-2xl rubik-bold">
                                    <!-- User initials will be inserted here -->
                                </div>
                                <h2 id="profile-name" class="rubik-bold text-xl text-gray-900 mb-1"></h2>
                                <p id="profile-title" class="text-gray-600 mb-2">Senior Frontend Developer</p>
                                <p id="profile-location" class="text-sm text-gray-500 mb-4"></p>
                                <button id="edit-profile-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg rubik-medium hover:bg-blue-700 transition-colors">
                                    Edit Profile
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Stats -->
                    <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                        <h3 class="rubik-semibold text-lg mb-4">Profile Stats</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Profile Views</span>
                                <span class="rubik-medium">127</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Applications Sent</span>
                                <span class="rubik-medium">23</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Interview Requests</span>
                                <span class="rubik-medium">5</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Profile Completion</span>
                                <span class="rubik-medium text-green-600">85%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Navigation Menu -->
                    <div class="bg-white rounded-lg shadow-sm p-6">
                        <nav class="space-y-2">
                            <a href="#overview" class="block px-4 py-2 text-blue-600 bg-blue-50 rounded-lg rubik-medium">Overview</a>
                            <a href="#applications" class="block px-4 py-2 text-gray-600 hover:text-blue-600 hover:bg-gray-50 rounded-lg transition-colors">My Applications</a>
                            <a href="#saved-jobs" class="block px-4 py-2 text-gray-600 hover:text-blue-600 hover:bg-gray-50 rounded-lg transition-colors">Saved Jobs</a>
                            <a href="#settings" class="block px-4 py-2 text-gray-600 hover:text-blue-600 hover:bg-gray-50 rounded-lg transition-colors">Settings</a>
                        </nav>
                    </div>
                </div>
                
                <!-- Main Content -->
                <div class="lg:w-2/3">
                    <!-- Overview Section -->
                    <div id="overview" class="mb-8">                        <!-- About Me -->
                        <div class="bg-white rounded-lg shadow-sm p-6 mb-6" id="about-section">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="rubik-bold text-xl">About Me</h3>
                                <button id="edit-about-btn" class="text-blue-600 hover:text-blue-700">Edit</button>
                            </div>
                            <div id="about-content">
                                <p id="about-text" class="text-gray-700 leading-relaxed">
                                    Loading profile information...
                                </p>
                            </div>
                            
                            <!-- Edit form (hidden by default) -->
                            <form id="about-edit-form" class="hidden">
                                <textarea id="about-textarea" class="w-full h-32 p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Tell us about yourself..."></textarea>
                                <div class="flex justify-end space-x-3 mt-3">
                                    <button type="button" id="cancel-about-btn" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancel</button>
                                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Save</button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Experience -->
                        <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="rubik-bold text-xl">Work Experience</h3>
                                <button class="text-blue-600 hover:text-blue-700">Add Experience</button>
                            </div>
                            <div class="space-y-6">
                                <div class="border-l-4 border-blue-600 pl-4">
                                    <div class="flex justify-between items-start mb-2">
                                        <div>
                                            <h4 class="rubik-semibold text-lg">Senior Frontend Developer</h4>
                                            <p class="text-blue-600 rubik-medium">TechCorp Inc.</p>
                                        </div>
                                        <span class="text-sm text-gray-500">2022 - Present</span>
                                    </div>
                                    <p class="text-gray-700 mb-3">Leading frontend development for enterprise web applications serving 100K+ users.</p>
                                    <div class="flex flex-wrap gap-2">
                                        <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">React</span>
                                        <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">TypeScript</span>
                                        <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">Next.js</span>
                                    </div>
                                </div>
                                
                                <div class="border-l-4 border-gray-300 pl-4">
                                    <div class="flex justify-between items-start mb-2">
                                        <div>
                                            <h4 class="rubik-semibold text-lg">Frontend Developer</h4>
                                            <p class="text-gray-600 rubik-medium">StartupXYZ</p>
                                        </div>
                                        <span class="text-sm text-gray-500">2020 - 2022</span>
                                    </div>
                                    <p class="text-gray-700 mb-3">Built responsive web applications and implemented modern UI/UX designs.</p>
                                    <div class="flex flex-wrap gap-2">
                                        <span class="bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">React</span>
                                        <span class="bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">JavaScript</span>
                                        <span class="bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">CSS</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Skills -->
                        <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="rubik-bold text-xl">Skills</h3>
                                <button class="text-blue-600 hover:text-blue-700">Edit Skills</button>
                            </div>
                            <div class="flex flex-wrap gap-3">
                                <span class="bg-blue-600 text-white px-4 py-2 rounded-full text-sm rubik-medium">React</span>
                                <span class="bg-blue-600 text-white px-4 py-2 rounded-full text-sm rubik-medium">TypeScript</span>
                                <span class="bg-blue-600 text-white px-4 py-2 rounded-full text-sm rubik-medium">JavaScript</span>
                                <span class="bg-blue-500 text-white px-4 py-2 rounded-full text-sm rubik-medium">Next.js</span>
                                <span class="bg-blue-500 text-white px-4 py-2 rounded-full text-sm rubik-medium">Tailwind CSS</span>
                                <span class="bg-blue-400 text-white px-4 py-2 rounded-full text-sm rubik-medium">Node.js</span>
                                <span class="bg-blue-400 text-white px-4 py-2 rounded-full text-sm rubik-medium">Git</span>
                                <span class="bg-blue-300 text-white px-4 py-2 rounded-full text-sm rubik-medium">Figma</span>
                            </div>
                        </div>
                        
                        <!-- Education -->
                        <div class="bg-white rounded-lg shadow-sm p-6">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="rubik-bold text-xl">Education</h3>
                                <button class="text-blue-600 hover:text-blue-700">Add Education</button>
                            </div>
                            <div class="border-l-4 border-green-600 pl-4">
                                <div class="flex justify-between items-start mb-2">
                                    <div>
                                        <h4 class="rubik-semibold text-lg">Bachelor of Science in Computer Science</h4>
                                        <p class="text-green-600 rubik-medium">University of California, Berkeley</p>
                                    </div>
                                    <span class="text-sm text-gray-500">2016 - 2020</span>
                                </div>
                                <p class="text-gray-700">Graduated Magna Cum Laude with focus on Software Engineering and Web Development.</p>
                            </div>
                        </div>
                    </div>
                      <!-- Recent Applications -->
                    <div id="applications" class="mb-8">
                        <div class="bg-white rounded-lg shadow-sm p-6">
                            <h3 class="rubik-bold text-xl mb-6">Recent Applications</h3>
                            <div id="applications-loading" class="text-center py-8">
                                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div>
                                <p class="text-gray-500 mt-2">Loading applications...</p>
                            </div>
                            <div id="applications-content" class="space-y-4 hidden">
                                <!-- Applications will be loaded here -->
                            </div>
                            <div id="applications-empty" class="hidden text-center py-8 text-gray-500">
                                <p>You haven't applied to any jobs yet.</p>
                                <a href="jobs.html" class="text-blue-600 hover:text-blue-700 mt-2 inline-block">Browse Jobs</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-gray-400">&copy; 2025 JobFinder. All rights reserved.</p>
        </div>
    </footer>    <!-- JavaScript -->
    <script src="../js/api.js"></script>    <script>
        // Initialize authentication state when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize authentication state
            initializeAuth();
            updateAuthUI();

            // Check if user is authenticated
            if (!authState.isAuthenticated) {
                window.location.href = 'login.html';
                return;
            }

            // Load user profile if authenticated
            loadUserProfile();
        });

        async function loadUserProfile() {
            try {
                // Load current user profile
                const profile = await UserAPI.getCurrentProfile();
                displayProfile(profile);
                
                // Load user applications (mock for now)
                loadUserApplications();
                
            } catch (error) {
                console.error('Error loading profile:', error);
                showProfileError();
            }
        }

        function displayProfile(profile) {
            // Hide loading state
            document.getElementById('profile-loading').classList.add('hidden');
            document.getElementById('profile-content').classList.remove('hidden');
            
            // Profile avatar (initials)
            const avatar = document.getElementById('profile-avatar');
            const initials = getInitials(profile.fullName || profile.username);
            avatar.textContent = initials;
            
            // Profile info
            document.getElementById('profile-name').textContent = profile.fullName || profile.username;
            document.getElementById('profile-location').textContent = profile.location || 'Location not specified';
            
            // About section
            const aboutText = document.getElementById('about-text');
            aboutText.textContent = profile.bio || 'No bio available. Click Edit to add information about yourself.';
        }

        function getInitials(name) {
            if (!name) return '?';
            return name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
        }

        function showProfileError() {
            document.getElementById('profile-loading').innerHTML = `
                <div class="text-red-600 text-center">
                    <p>Error loading profile</p>
                    <button onclick="loadUserProfile()" class="text-blue-600 hover:text-blue-700 mt-2">Try Again</button>
                </div>
            `;
        }

        function loadUserApplications() {
            // Mock applications data for now
            const applications = [];
            
            const loadingEl = document.getElementById('applications-loading');
            const contentEl = document.getElementById('applications-content');
            const emptyEl = document.getElementById('applications-empty');
            
            loadingEl.classList.add('hidden');
            
            if (applications.length === 0) {
                emptyEl.classList.remove('hidden');
            } else {
                contentEl.classList.remove('hidden');
                displayApplications(applications);
            }
        }

        function displayApplications(applications) {
            const container = document.getElementById('applications-content');
            container.innerHTML = applications.map(app => `
                <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center text-white rubik-bold text-lg mr-4">
                            ${app.company.charAt(0)}
                        </div>
                        <div>
                            <h4 class="rubik-semibold">${app.jobTitle}</h4>
                            <p class="text-gray-600">${app.company}</p>
                            <p class="text-sm text-gray-500">Applied ${app.appliedDate}</p>
                        </div>
                    </div>
                    <span class="bg-${app.statusColor}-100 text-${app.statusColor}-800 px-3 py-1 rounded-full text-sm">${app.status}</span>
                </div>
            `).join('');
        }

        // Edit profile functionality
        document.getElementById('edit-profile-btn').addEventListener('click', function() {
            // For now, just show an alert. Could implement a modal later
            alert('Profile editing coming soon! This will open a form to edit your profile information.');
        });

        // About section editing
        let isEditingAbout = false;
        
        document.getElementById('edit-about-btn').addEventListener('click', function() {
            if (isEditingAbout) return;
            
            const aboutContent = document.getElementById('about-content');
            const aboutForm = document.getElementById('about-edit-form');
            const aboutText = document.getElementById('about-text').textContent;
            
            document.getElementById('about-textarea').value = aboutText === 'No bio available. Click Edit to add information about yourself.' ? '' : aboutText;
            
            aboutContent.classList.add('hidden');
            aboutForm.classList.remove('hidden');
            isEditingAbout = true;
        });

        document.getElementById('cancel-about-btn').addEventListener('click', function() {
            cancelAboutEdit();
        });

        document.getElementById('about-edit-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const newBio = document.getElementById('about-textarea').value.trim();
            
            try {
                // Update profile with new bio
                await UserAPI.updateProfile({ bio: newBio });
                
                // Update display
                document.getElementById('about-text').textContent = newBio || 'No bio available. Click Edit to add information about yourself.';
                
                cancelAboutEdit();
                
                // Show success message
                showSuccessMessage('Bio updated successfully!');
                
            } catch (error) {
                console.error('Error updating bio:', error);
                alert('Error updating bio. Please try again.');
            }
        });

        function cancelAboutEdit() {
            document.getElementById('about-content').classList.remove('hidden');
            document.getElementById('about-edit-form').classList.add('hidden');
            isEditingAbout = false;
        }

        function showSuccessMessage(message) {
            const successEl = document.createElement('div');
            successEl.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            successEl.textContent = message;
            document.body.appendChild(successEl);
            
            setTimeout(() => {
                successEl.remove();
            }, 3000);
        }

        // Navigation menu functionality
        const navMenu = document.querySelector('.space-y-2');
        if (navMenu) {
            navMenu.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    e.preventDefault();
                    
                    // Remove active class from all links
                    const links = navMenu.querySelectorAll('a');
                    links.forEach(link => {
                        link.className = 'block px-4 py-2 text-gray-600 hover:text-blue-600 hover:bg-gray-50 rounded-lg transition-colors';
                    });
                    
                    // Add active class to clicked link
                    e.target.className = 'block px-4 py-2 text-blue-600 bg-blue-50 rounded-lg rubik-medium';
                    
                    // Handle navigation (for now just scroll to section)
                    const targetId = e.target.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth' });
                    }
                }
            });
        }
    </script>
</body>
</html>
